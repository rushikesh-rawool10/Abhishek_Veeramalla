prometheus & Grafana

minikube start --memory=4098 --driver=hyperkit, if we not use hyperkit it will use docker desktop as default and that needs additional network settings

minikube start --memory=4098 --driver=hyperkit

kubectl expose service prometheus-server --type=NodePort --target-port=9090 --name=prometheus-server-ext

curl -L http://192.168.49.2:31506/


minikube_ip:nodeport

expose service kube_state_metrics as nodeport to get all metrics information

how to access--> minikube_ip:nodeport/metrics

how to get metrics information inside prometheus=====

kubectl get cm (configMaps)

cm--> prometheus-server

kubectl edit cm prometheus-server

this will have all info about prometeus is scraping (prometheus.yml)

inside scape_configs:
  
   scape_configs:
   - job_name: prometheus
	 static_configs:
	 - targets:
	   - localhost: 9090
	
   - job_name: kube_metrics
	 static_configs:
	 - targets:
	   - minikube_ip: nodeport_of_kubeConfigs

========================================================NEW===========================
INstallation of prometheus and grafana

helm repo add prometheus-community
helm repo update
helm install prometheus prometheus-community

k get svc
expose prometheus-server service or in cluser use ingress to discover service

GRAFANA---

helm repo add grafana
helm repo update
helm install grafana

k export service grafana or in cluser use ingress to discover service


ADD Prometheus as Data source in Grafana
create dashboards

---------how to add new targets in prometheus

go to prometheus.yml

scrape_configs:
  - job_name: 'my-new-targets'
    static_configs:
      - targets: ['192.168.1.10:9100', '192.168.1.11:9100']

or

scrape_configs:
  - job_name: 'web-servers'
    static_configs:
      - targets: ['web1.local:8080', 'web2.local:8080']
        labels:
          group: 'frontend'

=======================Questions====
configure prometheus and graafana
loki
how does Prometheus collect metrics
what is log rotate job and how does it work
What are data sources for Grafana,

-->
. Prometheus Scrapes Metrics
- Prometheus reads its prometheus.yml config file to find targets.
- It sends HTTP GET requests to each targetâ€™s /metrics endpoint.
- The response contains raw metric data, which Prometheus stores in its time-series database (TSDB).









